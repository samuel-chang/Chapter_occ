---
title: "occUncertain-vigentte"
author: "Samuel Chang"
date: "3/5/2020"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{occUncertain-vigentte}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# 1. Load package and dataset 
```{r}
library(occUncertain)

#To demonstrate the use of the package occUncertain we used a set of four different datasets. This dataset is for 1480 georeferenced occurrence records in Colombiafor the spectacled bear (*Tremarctos ornatus*). These occurrences dataset are from the Global Biodiversity Information Facility (19 May 2020) GBIF Occurrence Download https://doi.org/10.15468/dl.6ykjg7

load("~/GitHub/ENS Master/Chapter1/Chapter_uno/data/T_ornatus_CO.RData")
```

# 2. meters_to_decdeg function
```{r uncertainty from meter to radian degrees }
#NA as 0
T_ornatus_CO_uncertainty_naZero <-
  meters_to_decdeg(
    T_ornatus_CO,
    lat_col = "decimalLatitude",
    lon_col = "decimalLongitude",
    distance = "coordinateUncertaintyInMeters",
    na_action = "NA as 0"
  )
head(T_ornatus_CO_uncertainty_naZero)

T_ornatus_CO_uncertainty_naZero <-
  cbind(T_ornatus_CO, T_ornatus_CO_uncertainty_naZero)
head(T_ornatus_CO_uncertainty_naZero)

#NA as Mean
T_ornatus_CO_uncertainty_naMean <- meters_to_decdeg(
  T_ornatus_CO,
  lat_col = "decimalLatitude",
  lon_col = "decimalLongitude",
  distance = "coordinateUncertaintyInMeters",
  na_action = "NA as mean"
)

T_ornatus_CO_uncertainty_naMean <-
  cbind(T_ornatus_CO, T_ornatus_CO_uncertainty_naMean)
head(T_ornatus_CO_uncertainty_naMean)

#NA as NA
T_ornatus_CO_uncertainty_naNA <-
  meters_to_decdeg(
    T_ornatus_CO,
    lat_col = "decimalLatitude",
    lon_col = "decimalLongitude",
    distance = "coordinateUncertaintyInMeters",
    na_action = "NA as NA"
  )
head(T_ornatus_CO_uncertainty_naNA)

T_ornatus_CO_uncertainty_naNA <-
  cbind(T_ornatus_CO, T_ornatus_CO_uncertainty_naNA)
head(T_ornatus_CO_uncertainty_naNA)

#filter occ that have NA uncertainty 
T_ornatus_CO_uncertainty_naNA <-
  dplyr::filter(T_ornatus_CO_uncertainty_naNA,
    !is.na(coordinateUncertaintyInMeters))
```

# 3. Using the random occurences in land metrics using function randon_geo_range

# The Extent of Occurrence (EOO) is the area contained within the shortest continuous imaginary boundary which can be drawn to encompass all the known, inferred or projected sites of present occurrence of a taxon, excluding cases of vagrancy. (IUCN 2012). The area known or predicted cells occupied by a taxon within its extent of occurrence, represents suitable and occupied habitats is known as the area of occupancy (AOO). 
AOO is calculatlaed as the area of all  for the species. The resolution will be 2x2km as required by IUCN.

```{r land metrics}
T_ornatus_CO_naMean_geo_range_100 <-
  random_geo_range(
    100,
    T_ornatus_CO_uncertainty_naMean,
    lat_col = "decimalLatitude",
    lon_col = "decimalLongitude",
    lat_uncertainty = "lat_uncertainty",
    lon_uncertainty = "lon_uncertainty",
  )
names(T_ornatus_CO_naMean_geo_range_100)[1] <- "Mean_EOO"
names(T_ornatus_CO_naMean_geo_range_100)[2] <- "Mean_AOO"

T_ornatus_CO_naZero_geo_range_100 <-
  random_geo_range(
    100,
    T_ornatus_CO_uncertainty_naZero,
    lat_col = "decimalLatitude",
    lon_col = "decimalLongitude",
    lat_uncertainty = "lat_uncertainty",
    lon_uncertainty = "lon_uncertainty",
  )
names(T_ornatus_CO_naZero_geo_range_100)[1] <- "Zero_EOO"
names(T_ornatus_CO_naZero_geo_range_100)[2] <- "Zero_AOO"


T_ornatus_CO_naNA_geo_range_100 <-
  random_geo_range(
    100,
    T_ornatus_CO_uncertainty_naNA,
    lat_col = "decimalLatitude",
    lon_col = "decimalLongitude",
    lat_uncertainty = "lat_uncertainty",
    lon_uncertainty = "lon_uncertainty",
  )
names(T_ornatus_CO_naNA_geo_range_100)[1] <- "NA_EOO"
names(T_ornatus_CO_naNA_geo_range_100)[2] <- "NA_AOO"

T_ornatus_CO_georanges_100 <-
  cbind(
    T_ornatus_CO_naMean_geo_range_100,
    T_ornatus_CO_naZero_geo_range_100,
    T_ornatus_CO_naNA_geo_range_100
  )

write.csv2(T_ornatus_CO_georanges_100, "~/GitHub/ENS Master/Chapter1/Chapter_uno/data/T_ornatus_CO_georanges_100.csv" )

T_ornatus_CO_georanges_100 <-
  read_delim(
    "data/T_ornatus_CO_georanges_100.csv",
    ";",
    dec = ",",
    escape_double = FALSE,
    trim_ws = TRUE
  )

```



